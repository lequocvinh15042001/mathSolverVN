{"ast":null,"code":"import _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\nimport * as React from 'react';\nimport Icon from '../../components/Icon';\nimport i18n from '../../i18n';\nimport { PluginComponent } from '../Plugin';\nimport LoggerPlugin from './logger';\nvar LOGGER_INTERVAL = 600;\n\nvar Logger = /*#__PURE__*/function (_PluginComponent) {\n  _inheritsLoose(Logger, _PluginComponent);\n\n  function Logger(props) {\n    var _this;\n\n    _this = _PluginComponent.call(this, props) || this;\n    _this.handleKeyboards = [];\n    _this.lastPop = null;\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleRedo = _this.handleRedo.bind(_assertThisInitialized(_this));\n    _this.handleUndo = _this.handleUndo.bind(_assertThisInitialized(_this)); // Mac的Redo比较特殊，是Command+Shift+Z，优先处理\n\n    _this.handleKeyboards = [{\n      key: 'y',\n      keyCode: 89,\n      withKey: ['ctrlKey'],\n      callback: _this.handleRedo\n    }, {\n      key: 'z',\n      keyCode: 90,\n      withKey: ['metaKey', 'shiftKey'],\n      callback: _this.handleRedo\n    }, {\n      key: 'z',\n      keyCode: 90,\n      aliasCommand: true,\n      withKey: ['ctrlKey'],\n      callback: _this.handleUndo\n    }];\n    _this.logger = new LoggerPlugin();\n    return _this;\n  }\n\n  var _proto = Logger.prototype;\n\n  _proto.handleUndo = function handleUndo() {\n    var last = this.logger.undo(this.editor.getMdValue());\n\n    if (typeof last !== 'undefined') {\n      this.pause();\n      this.lastPop = last;\n      this.editor.setText(last);\n      this.forceUpdate();\n    }\n  };\n\n  _proto.handleRedo = function handleRedo() {\n    var last = this.logger.redo();\n\n    if (typeof last !== 'undefined') {\n      this.lastPop = last;\n      this.editor.setText(last);\n      this.forceUpdate();\n    }\n  };\n\n  _proto.handleChange = function handleChange(value, e, isChange) {\n    var _this2 = this;\n\n    if (this.logger.getLast() === value || this.lastPop !== null && this.lastPop === value) {\n      return;\n    }\n\n    this.logger.cleanRedo();\n\n    if (isChange) {\n      this.logger.push(value);\n      this.lastPop = null;\n      this.forceUpdate();\n      return;\n    }\n\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n      this.timerId = 0;\n    }\n\n    this.timerId = window.setTimeout(function () {\n      if (_this2.logger.getLast() !== value) {\n        _this2.logger.push(value);\n\n        _this2.lastPop = null;\n\n        _this2.forceUpdate();\n      }\n\n      window.clearTimeout(_this2.timerId);\n      _this2.timerId = 0;\n    }, LOGGER_INTERVAL);\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this3 = this; // 监听变化事件\n\n\n    this.editor.on('change', this.handleChange); // 监听键盘事件\n\n    this.handleKeyboards.forEach(function (it) {\n      return _this3.editor.onKeyboard(it);\n    }); // 初始化时，把已有值填充进logger\n\n    this.logger.initValue = this.editor.getMdValue();\n    this.forceUpdate();\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    var _this4 = this;\n\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n    }\n\n    this.editor.off('change', this.handleChange);\n    this.handleKeyboards.forEach(function (it) {\n      return _this4.editor.offKeyboard(it);\n    });\n  };\n\n  _proto.pause = function pause() {\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n      this.timerId = undefined;\n    }\n  };\n\n  _proto.render = function render() {\n    var hasUndo = this.logger.getUndoCount() > 1 || this.logger.initValue !== this.editor.getMdValue();\n    var hasRedo = this.logger.getRedoCount() > 0;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-undo \" + (hasUndo ? '' : 'disabled'),\n      title: i18n.get('btnUndo'),\n      onClick: this.handleUndo\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"undo\"\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-redo \" + (hasRedo ? '' : 'disabled'),\n      title: i18n.get('btnRedo'),\n      onClick: this.handleRedo\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"redo\"\n    })));\n  };\n\n  return Logger;\n}(PluginComponent);\n\nLogger.pluginName = 'logger';\nexport { Logger as default };","map":{"version":3,"names":["_assertThisInitialized","_inheritsLoose","React","Icon","i18n","PluginComponent","LoggerPlugin","LOGGER_INTERVAL","Logger","_PluginComponent","props","_this","call","handleKeyboards","lastPop","handleChange","bind","handleRedo","handleUndo","key","keyCode","withKey","callback","aliasCommand","logger","_proto","prototype","last","undo","editor","getMdValue","pause","setText","forceUpdate","redo","value","e","isChange","_this2","getLast","cleanRedo","push","timerId","window","clearTimeout","setTimeout","componentDidMount","_this3","on","forEach","it","onKeyboard","initValue","componentWillUnmount","_this4","off","offKeyboard","undefined","render","hasUndo","getUndoCount","hasRedo","getRedoCount","createElement","Fragment","className","title","get","onClick","type","pluginName","default"],"sources":["/Users/lequocvinh/MathSolver/mathSolverVN/node_modules/react-markdown-editor-lite/esm/plugins/logger/index.js"],"sourcesContent":["import _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\nimport * as React from 'react';\nimport Icon from '../../components/Icon';\nimport i18n from '../../i18n';\nimport { PluginComponent } from '../Plugin';\nimport LoggerPlugin from './logger';\nvar LOGGER_INTERVAL = 600;\n\nvar Logger = /*#__PURE__*/function (_PluginComponent) {\n  _inheritsLoose(Logger, _PluginComponent);\n\n  function Logger(props) {\n    var _this;\n\n    _this = _PluginComponent.call(this, props) || this;\n    _this.handleKeyboards = [];\n    _this.lastPop = null;\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleRedo = _this.handleRedo.bind(_assertThisInitialized(_this));\n    _this.handleUndo = _this.handleUndo.bind(_assertThisInitialized(_this)); // Mac的Redo比较特殊，是Command+Shift+Z，优先处理\n\n    _this.handleKeyboards = [{\n      key: 'y',\n      keyCode: 89,\n      withKey: ['ctrlKey'],\n      callback: _this.handleRedo\n    }, {\n      key: 'z',\n      keyCode: 90,\n      withKey: ['metaKey', 'shiftKey'],\n      callback: _this.handleRedo\n    }, {\n      key: 'z',\n      keyCode: 90,\n      aliasCommand: true,\n      withKey: ['ctrlKey'],\n      callback: _this.handleUndo\n    }];\n    _this.logger = new LoggerPlugin();\n    return _this;\n  }\n\n  var _proto = Logger.prototype;\n\n  _proto.handleUndo = function handleUndo() {\n    var last = this.logger.undo(this.editor.getMdValue());\n\n    if (typeof last !== 'undefined') {\n      this.pause();\n      this.lastPop = last;\n      this.editor.setText(last);\n      this.forceUpdate();\n    }\n  };\n\n  _proto.handleRedo = function handleRedo() {\n    var last = this.logger.redo();\n\n    if (typeof last !== 'undefined') {\n      this.lastPop = last;\n      this.editor.setText(last);\n      this.forceUpdate();\n    }\n  };\n\n  _proto.handleChange = function handleChange(value, e, isChange) {\n    var _this2 = this;\n\n    if (this.logger.getLast() === value || this.lastPop !== null && this.lastPop === value) {\n      return;\n    }\n\n    this.logger.cleanRedo();\n\n    if (isChange) {\n      this.logger.push(value);\n      this.lastPop = null;\n      this.forceUpdate();\n      return;\n    }\n\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n      this.timerId = 0;\n    }\n\n    this.timerId = window.setTimeout(function () {\n      if (_this2.logger.getLast() !== value) {\n        _this2.logger.push(value);\n\n        _this2.lastPop = null;\n\n        _this2.forceUpdate();\n      }\n\n      window.clearTimeout(_this2.timerId);\n      _this2.timerId = 0;\n    }, LOGGER_INTERVAL);\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this3 = this;\n\n    // 监听变化事件\n    this.editor.on('change', this.handleChange); // 监听键盘事件\n\n    this.handleKeyboards.forEach(function (it) {\n      return _this3.editor.onKeyboard(it);\n    }); // 初始化时，把已有值填充进logger\n\n    this.logger.initValue = this.editor.getMdValue();\n    this.forceUpdate();\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    var _this4 = this;\n\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n    }\n\n    this.editor.off('change', this.handleChange);\n    this.handleKeyboards.forEach(function (it) {\n      return _this4.editor.offKeyboard(it);\n    });\n  };\n\n  _proto.pause = function pause() {\n    if (this.timerId) {\n      window.clearTimeout(this.timerId);\n      this.timerId = undefined;\n    }\n  };\n\n  _proto.render = function render() {\n    var hasUndo = this.logger.getUndoCount() > 1 || this.logger.initValue !== this.editor.getMdValue();\n    var hasRedo = this.logger.getRedoCount() > 0;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-undo \" + (hasUndo ? '' : 'disabled'),\n      title: i18n.get('btnUndo'),\n      onClick: this.handleUndo\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"undo\"\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-redo \" + (hasRedo ? '' : 'disabled'),\n      title: i18n.get('btnRedo'),\n      onClick: this.handleRedo\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"redo\"\n    })));\n  };\n\n  return Logger;\n}(PluginComponent);\n\nLogger.pluginName = 'logger';\nexport { Logger as default };"],"mappings":"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"},"metadata":{},"sourceType":"module"}