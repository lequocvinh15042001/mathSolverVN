{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nimport * as React from 'react';\nimport Icon from '../components/Icon';\nimport NavigationBar from '../components/NavigationBar';\nimport ToolBar from '../components/ToolBar';\nimport i18n from '../i18n';\nimport DividerPlugin from '../plugins/divider';\nimport Emitter, { globalEmitter } from '../share/emitter';\nimport { initialSelection } from '../share/var';\nimport getDecorated from '../utils/decorate';\nimport mergeConfig from '../utils/mergeConfig';\nimport { getLineAndCol, isKeyMatch, isPromise } from '../utils/tool';\nimport getUploadPlaceholder from '../utils/uploadPlaceholder';\nimport defaultConfig from './defaultConfig';\nimport { HtmlRender } from './preview';\n\nvar Editor = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Editor, _React$Component);\n  /**\n   * Register plugin\n   * @param {any} comp Plugin component\n   * @param {any} config Other configs\n   */\n\n\n  Editor.use = function use(comp, config) {\n    if (config === void 0) {\n      config = {};\n    } // Check for duplicate plugins\n\n\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1, {\n          comp: comp,\n          config: config\n        });\n        return;\n      }\n    }\n\n    Editor.plugins.push({\n      comp: comp,\n      config: config\n    });\n  }\n  /**\n   * Unregister plugin\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuse = function unuse(comp) {\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1);\n        return;\n      }\n    }\n  }\n  /**\n   * Unregister all plugins\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuseAll = function unuseAll() {\n    Editor.plugins = [];\n  }\n  /**\n   * Locales\n   */\n  ;\n\n  function Editor(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreview = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.hasContentChanged = true;\n    _this.scrollScale = 1;\n    _this.isSyncingScroll = false;\n    _this.shouldSyncScroll = 'md';\n    _this.keyboardListeners = [];\n    _this.emitter = new Emitter();\n    _this.config = mergeConfig(defaultConfig, _this.props.config, _this.props);\n    _this.state = {\n      text: (_this.props.value || _this.props.defaultValue || '').replace(/↵/g, '\\n'),\n      html: '',\n      view: _this.config.view || defaultConfig.view,\n      fullScreen: false,\n      plugins: _this.getPlugins()\n    };\n\n    if (_this.config.canView && !_this.config.canView.menu) {\n      _this.state.view.menu = false;\n    }\n\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handlePaste = _this.handlePaste.bind(_assertThisInitialized(_this));\n    _this.handleDrop = _this.handleDrop.bind(_assertThisInitialized(_this));\n    _this.handleToggleMenu = _this.handleToggleMenu.bind(_assertThisInitialized(_this));\n    _this.handleKeyDown = _this.handleKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleEditorKeyDown = _this.handleEditorKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleLocaleUpdate = _this.handleLocaleUpdate.bind(_assertThisInitialized(_this));\n    _this.handleFocus = _this.handleFocus.bind(_assertThisInitialized(_this));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_this));\n    _this.handleInputScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'md');\n    _this.handlePreviewScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'html');\n    return _this;\n  }\n\n  var _proto = Editor.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var text = this.state.text;\n    this.renderHTML(text);\n    globalEmitter.on(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate); // init i18n\n\n    i18n.setUp();\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    globalEmitter.off(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate);\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (typeof this.props.value !== 'undefined' && this.props.value !== this.state.text) {\n      var value = this.props.value;\n\n      if (typeof value !== 'string') {\n        value = String(value).toString();\n      }\n\n      value = value.replace(/↵/g, '\\n');\n\n      if (this.state.text !== value) {\n        this.setState({\n          text: value\n        });\n        this.renderHTML(value);\n      }\n    }\n\n    if (prevProps.plugins !== this.props.plugins) {\n      this.setState({\n        plugins: this.getPlugins()\n      });\n    }\n  };\n\n  _proto.getPlugins = function getPlugins() {\n    var _this2 = this;\n\n    var plugins = [];\n\n    if (this.props.plugins) {\n      // If plugins option is configured, use only specified plugins\n      var addToPlugins = function addToPlugins(name) {\n        if (name === DividerPlugin.pluginName) {\n          plugins.push({\n            comp: DividerPlugin,\n            config: {}\n          });\n          return;\n        }\n\n        for (var _iterator = _createForOfIteratorHelperLoose(Editor.plugins), _step; !(_step = _iterator()).done;) {\n          var it = _step.value;\n\n          if (it.comp.pluginName === name) {\n            plugins.push(it);\n            return;\n          }\n        }\n      };\n\n      for (var _iterator2 = _createForOfIteratorHelperLoose(this.props.plugins), _step2; !(_step2 = _iterator2()).done;) {\n        var name = _step2.value; // Special handling of fonts to ensure backward compatibility\n\n        if (name === 'fonts') {\n          addToPlugins('font-bold');\n          addToPlugins('font-italic');\n          addToPlugins('font-underline');\n          addToPlugins('font-strikethrough');\n          addToPlugins('list-unordered');\n          addToPlugins('list-ordered');\n          addToPlugins('block-quote');\n          addToPlugins('block-wrap');\n          addToPlugins('block-code-inline');\n          addToPlugins('block-code-block');\n        } else {\n          addToPlugins(name);\n        }\n      }\n    } else {\n      // Use all registered plugins\n      plugins = [].concat(Editor.plugins);\n    }\n\n    var result = {};\n    plugins.forEach(function (it) {\n      if (typeof result[it.comp.align] === 'undefined') {\n        result[it.comp.align] = [];\n      }\n\n      result[it.comp.align].push( /*#__PURE__*/React.createElement(it.comp, {\n        editor: _this2,\n        editorConfig: _this2.config,\n        config: _extends({}, it.comp.defaultConfig || {}, it.config || {}),\n        key: it.comp.pluginName\n      }));\n    });\n    return result;\n  } // sync left and right section's scroll\n  ;\n\n  _proto.handleSyncScroll = function handleSyncScroll(type, e) {\n    var _this3 = this; // prevent loop\n\n\n    if (type !== this.shouldSyncScroll) {\n      return;\n    } // trigger events\n\n\n    if (this.props.onScroll) {\n      this.props.onScroll(e, type);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_SCROLL, e, type); // should sync scroll?\n\n    var _this$config$syncScro = this.config.syncScrollMode,\n        syncScrollMode = _this$config$syncScro === void 0 ? [] : _this$config$syncScro;\n\n    if (!syncScrollMode.includes(type === 'md' ? 'rightFollowLeft' : 'leftFollowRight')) {\n      return;\n    }\n\n    if (this.hasContentChanged && this.nodeMdText.current && this.nodeMdPreviewWrapper.current) {\n      // 计算出左右的比例\n      this.scrollScale = this.nodeMdText.current.scrollHeight / this.nodeMdPreviewWrapper.current.scrollHeight;\n      this.hasContentChanged = false;\n    }\n\n    if (!this.isSyncingScroll) {\n      this.isSyncingScroll = true;\n      requestAnimationFrame(function () {\n        if (_this3.nodeMdText.current && _this3.nodeMdPreviewWrapper.current) {\n          if (type === 'md') {\n            // left to right\n            _this3.nodeMdPreviewWrapper.current.scrollTop = _this3.nodeMdText.current.scrollTop / _this3.scrollScale;\n          } else {\n            // right to left\n            _this3.nodeMdText.current.scrollTop = _this3.nodeMdPreviewWrapper.current.scrollTop * _this3.scrollScale;\n          }\n        }\n\n        _this3.isSyncingScroll = false;\n      });\n    }\n  };\n\n  _proto.renderHTML = function renderHTML(markdownText) {\n    var _this4 = this;\n\n    if (!this.props.renderHTML) {\n      console.error('renderHTML props is required!');\n      return Promise.resolve();\n    }\n\n    var res = this.props.renderHTML(markdownText);\n\n    if (isPromise(res)) {\n      // @ts-ignore\n      return res.then(function (r) {\n        return _this4.setHtml(r);\n      });\n    }\n\n    if (typeof res === 'function') {\n      return this.setHtml(res());\n    }\n\n    return this.setHtml(res);\n  };\n\n  _proto.setHtml = function setHtml(html) {\n    var _this5 = this;\n\n    return new Promise(function (resolve) {\n      _this5.setState({\n        html: html\n      }, resolve);\n    });\n  };\n\n  _proto.handleToggleMenu = function handleToggleMenu() {\n    this.setView({\n      menu: !this.state.view.menu\n    });\n  };\n\n  _proto.handleFocus = function handleFocus(e) {\n    var onFocus = this.props.onFocus;\n\n    if (onFocus) {\n      onFocus(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_FOCUS, e);\n  };\n\n  _proto.handleBlur = function handleBlur(e) {\n    var onBlur = this.props.onBlur;\n\n    if (onBlur) {\n      onBlur(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_BLUR, e);\n  }\n  /**\n   * Text area change event\n   * @param {React.ChangeEvent} e\n   */\n  ;\n\n  _proto.handleChange = function handleChange(e) {\n    e.persist();\n    var value = e.target.value; // 触发内部事件\n\n    this.setText(value, e);\n  }\n  /**\n   * Listen paste event to support paste images\n   */\n  ;\n\n  _proto.handlePaste = function handlePaste(e) {\n    if (!this.config.allowPasteImage || !this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent; // @ts-ignore\n\n    var items = (event.clipboardData || window.clipboardData).items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  } // Drag images to upload\n  ;\n\n  _proto.handleDrop = function handleDrop(e) {\n    if (!this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent;\n\n    if (!event.dataTransfer) {\n      return;\n    }\n\n    var items = event.dataTransfer.items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  };\n\n  _proto.handleEditorKeyDown = function handleEditorKeyDown(e) {\n    var _this6 = this;\n\n    var keyCode = e.keyCode,\n        key = e.key,\n        currentTarget = e.currentTarget;\n\n    if (keyCode === 13 || key === 'Enter') {\n      var _text = e.currentTarget.value;\n      var curPos = currentTarget.selectionStart;\n      var lineInfo = getLineAndCol(_text, curPos);\n\n      var emptyCurrentLine = function emptyCurrentLine() {\n        var newValue = currentTarget.value.substr(0, curPos - lineInfo.curLine.length) + currentTarget.value.substr(curPos);\n\n        _this6.setText(newValue, undefined, {\n          start: curPos - lineInfo.curLine.length,\n          end: curPos - lineInfo.curLine.length\n        });\n\n        e.preventDefault();\n      };\n\n      var addSymbol = function addSymbol(symbol) {\n        _this6.insertText(\"\\n\" + symbol, false, {\n          start: symbol.length + 1,\n          end: symbol.length + 1\n        });\n\n        e.preventDefault();\n      }; // Enter key, check previous line\n\n\n      var isSymbol = lineInfo.curLine.match(/^(\\s?)([-*]) /);\n\n      if (isSymbol) {\n        if (/^(\\s?)([-*]) $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        addSymbol(isSymbol[0]);\n        return;\n      }\n\n      var isOrderList = lineInfo.curLine.match(/^(\\s?)(\\d+)\\. /);\n\n      if (isOrderList) {\n        if (/^(\\s?)(\\d+)\\. $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        var toInsert = \"\" + isOrderList[1] + (parseInt(isOrderList[2], 10) + 1) + \". \";\n        addSymbol(toInsert);\n      }\n    }\n  } // Handle language change\n  ;\n\n  _proto.handleLocaleUpdate = function handleLocaleUpdate() {\n    this.forceUpdate();\n  }\n  /**\n   * Get elements\n   */\n  ;\n\n  _proto.getMdElement = function getMdElement() {\n    return this.nodeMdText.current;\n  };\n\n  _proto.getHtmlElement = function getHtmlElement() {\n    return this.nodeMdPreviewWrapper.current;\n  }\n  /**\n   * Clear selected\n   */\n  ;\n\n  _proto.clearSelection = function clearSelection() {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(0, 0, 'none');\n    }\n  }\n  /**\n   * Get selected\n   * @return {Selection}\n   */\n  ;\n\n  _proto.getSelection = function getSelection() {\n    var source = this.nodeMdText.current;\n\n    if (!source) {\n      return _extends({}, initialSelection);\n    }\n\n    var start = source.selectionStart;\n    var end = source.selectionEnd;\n    var text = (source.value || '').slice(start, end);\n    return {\n      start: start,\n      end: end,\n      text: text\n    };\n  }\n  /**\n   * Set selected\n   * @param {Selection} to\n   */\n  ;\n\n  _proto.setSelection = function setSelection(to) {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(to.start, to.end, 'forward');\n      this.nodeMdText.current.focus();\n    }\n  }\n  /**\n   * Insert markdown text\n   * @param type\n   * @param option\n   */\n  ;\n\n  _proto.insertMarkdown = function insertMarkdown(type, option) {\n    if (option === void 0) {\n      option = {};\n    }\n\n    var curSelection = this.getSelection();\n    var decorateOption = option ? _extends({}, option) : {};\n\n    if (type === 'image') {\n      decorateOption = _extends({}, decorateOption, {\n        target: option.target || curSelection.text || '',\n        imageUrl: option.imageUrl || this.config.imageUrl\n      });\n    }\n\n    if (type === 'link') {\n      decorateOption = _extends({}, decorateOption, {\n        linkUrl: this.config.linkUrl\n      });\n    }\n\n    if (type === 'tab' && curSelection.start !== curSelection.end) {\n      var curLineStart = this.getMdValue().slice(0, curSelection.start).lastIndexOf('\\n') + 1;\n      this.setSelection({\n        start: curLineStart,\n        end: curSelection.end\n      });\n    }\n\n    var decorate = getDecorated(curSelection.text, type, decorateOption);\n    var text = decorate.text;\n    var selection = decorate.selection;\n\n    if (decorate.newBlock) {\n      var startLineInfo = getLineAndCol(this.getMdValue(), curSelection.start);\n      var col = startLineInfo.col,\n          curLine = startLineInfo.curLine;\n\n      if (col > 0 && curLine.length > 0) {\n        text = \"\\n\" + text;\n\n        if (selection) {\n          selection.start++;\n          selection.end++;\n        }\n      }\n\n      var afterText = startLineInfo.afterText;\n\n      if (curSelection.start !== curSelection.end) {\n        afterText = getLineAndCol(this.getMdValue(), curSelection.end).afterText;\n      }\n\n      if (afterText.trim() !== '' && afterText.substr(0, 2) !== '\\n\\n') {\n        if (afterText.substr(0, 1) !== '\\n') {\n          text += '\\n';\n        }\n\n        text += '\\n';\n      }\n    }\n\n    this.insertText(text, true, selection);\n  }\n  /**\n   * Insert a placeholder, and replace it when the Promise resolved\n   * @param placeholder\n   * @param wait\n   */\n  ;\n\n  _proto.insertPlaceholder = function insertPlaceholder(placeholder, wait) {\n    var _this7 = this;\n\n    this.insertText(placeholder, true);\n    wait.then(function (str) {\n      var text = _this7.getMdValue().replace(placeholder, str);\n\n      _this7.setText(text);\n    });\n  }\n  /**\n   * Insert text\n   * @param {string} value The text will be insert\n   * @param {boolean} replaceSelected Replace selected text\n   * @param {Selection} newSelection New selection\n   */\n  ;\n\n  _proto.insertText = function insertText(value, replaceSelected, newSelection) {\n    if (value === void 0) {\n      value = '';\n    }\n\n    if (replaceSelected === void 0) {\n      replaceSelected = false;\n    }\n\n    var text = this.state.text;\n    var selection = this.getSelection();\n    var beforeContent = text.slice(0, selection.start);\n    var afterContent = text.slice(replaceSelected ? selection.end : selection.start, text.length);\n    this.setText(beforeContent + value + afterContent, undefined, newSelection ? {\n      start: newSelection.start + beforeContent.length,\n      end: newSelection.end + beforeContent.length\n    } : {\n      start: selection.start,\n      end: selection.start\n    });\n  }\n  /**\n   * Set text, and trigger onChange event\n   * @param {string} value\n   * @param {any} event\n   */\n  ;\n\n  _proto.setText = function setText(value, event, newSelection) {\n    var _this8 = this;\n\n    if (value === void 0) {\n      value = '';\n    }\n\n    var _this$config$onChange = this.config.onChangeTrigger,\n        onChangeTrigger = _this$config$onChange === void 0 ? 'both' : _this$config$onChange;\n    var text = value.replace(/↵/g, '\\n');\n\n    if (this.state.text === value) {\n      return;\n    }\n\n    this.setState({\n      text: text\n    });\n\n    if (this.props.onChange && (onChangeTrigger === 'both' || onChangeTrigger === 'beforeRender')) {\n      this.props.onChange({\n        text: text,\n        html: this.getHtmlValue()\n      }, event);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_CHANGE, value, event, typeof event === 'undefined');\n\n    if (newSelection) {\n      setTimeout(function () {\n        return _this8.setSelection(newSelection);\n      });\n    }\n\n    if (!this.hasContentChanged) {\n      this.hasContentChanged = true;\n    }\n\n    var rendering = this.renderHTML(text);\n\n    if (onChangeTrigger === 'both' || onChangeTrigger === 'afterRender') {\n      rendering.then(function () {\n        if (_this8.props.onChange) {\n          _this8.props.onChange({\n            text: _this8.state.text,\n            html: _this8.getHtmlValue()\n          }, event);\n        }\n      });\n    }\n  }\n  /**\n   * Get text value\n   * @return {string}\n   */\n  ;\n\n  _proto.getMdValue = function getMdValue() {\n    return this.state.text;\n  }\n  /**\n   * Get rendered html\n   * @returns {string}\n   */\n  ;\n\n  _proto.getHtmlValue = function getHtmlValue() {\n    if (typeof this.state.html === 'string') {\n      return this.state.html;\n    }\n\n    if (this.nodeMdPreview.current) {\n      return this.nodeMdPreview.current.getHtml();\n    }\n\n    return '';\n  }\n  /**\n   * Listen keyboard events\n   */\n  ;\n  /**\n   * Listen keyboard events\n   * @param {KeyboardEventListener} data\n   */\n\n\n  _proto.onKeyboard = function onKeyboard(data) {\n    var _this9 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this9.onKeyboard(it);\n      });\n      return;\n    }\n\n    if (!this.keyboardListeners.includes(data)) {\n      this.keyboardListeners.push(data);\n    }\n  }\n  /**\n   * Unlisten keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  ;\n\n  _proto.offKeyboard = function offKeyboard(data) {\n    var _this10 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this10.offKeyboard(it);\n      });\n      return;\n    }\n\n    var index = this.keyboardListeners.indexOf(data);\n\n    if (index >= 0) {\n      this.keyboardListeners.splice(index, 1);\n    }\n  };\n\n  _proto.handleKeyDown = function handleKeyDown(e) {\n    // 遍历监听数组，找找有没有被监听\n    for (var _iterator3 = _createForOfIteratorHelperLoose(this.keyboardListeners), _step3; !(_step3 = _iterator3()).done;) {\n      var it = _step3.value;\n\n      if (isKeyMatch(e, it)) {\n        e.preventDefault();\n        it.callback(e);\n        return;\n      }\n    } // 如果没有，触发默认事件\n\n\n    this.emitter.emit(this.emitter.EVENT_KEY_DOWN, e);\n  };\n\n  _proto.getEventType = function getEventType(event) {\n    switch (event) {\n      case 'change':\n        return this.emitter.EVENT_CHANGE;\n\n      case 'fullscreen':\n        return this.emitter.EVENT_FULL_SCREEN;\n\n      case 'viewchange':\n        return this.emitter.EVENT_VIEW_CHANGE;\n\n      case 'keydown':\n        return this.emitter.EVENT_KEY_DOWN;\n\n      case 'blur':\n        return this.emitter.EVENT_BLUR;\n\n      case 'focus':\n        return this.emitter.EVENT_FOCUS;\n\n      case 'scroll':\n        return this.emitter.EVENT_SCROLL;\n    }\n  }\n  /**\n   * Listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.on = function on(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.on(eventType, cb);\n    }\n  }\n  /**\n   * Unlisten events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.off = function off(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.off(eventType, cb);\n    }\n  }\n  /**\n   * Set view property\n   * Can show or hide: editor, preview, menu\n   * @param {object} to\n   */\n  ;\n\n  _proto.setView = function setView(to) {\n    var _this11 = this;\n\n    var newView = _extends({}, this.state.view, to);\n\n    this.setState({\n      view: newView\n    }, function () {\n      _this11.emitter.emit(_this11.emitter.EVENT_VIEW_CHANGE, newView);\n    });\n  }\n  /**\n   * Get view property\n   * @return {object}\n   */\n  ;\n\n  _proto.getView = function getView() {\n    return _extends({}, this.state.view);\n  }\n  /**\n   * Enter or exit full screen\n   * @param {boolean} enable\n   */\n  ;\n\n  _proto.fullScreen = function fullScreen(enable) {\n    var _this12 = this;\n\n    if (this.state.fullScreen !== enable) {\n      this.setState({\n        fullScreen: enable\n      }, function () {\n        _this12.emitter.emit(_this12.emitter.EVENT_FULL_SCREEN, enable);\n      });\n    }\n  }\n  /**\n   * Is full screen\n   * @return {boolean}\n   */\n  ;\n\n  _proto.isFullScreen = function isFullScreen() {\n    return this.state.fullScreen;\n  };\n\n  _proto.uploadWithDataTransfer = function uploadWithDataTransfer(items) {\n    var _this13 = this;\n\n    var onImageUpload = this.config.onImageUpload;\n\n    if (!onImageUpload) {\n      return;\n    }\n\n    var queue = [];\n    Array.prototype.forEach.call(items, function (it) {\n      if (it.kind === 'file' && it.type.includes('image')) {\n        var file = it.getAsFile();\n\n        if (file) {\n          var placeholder = getUploadPlaceholder(file, onImageUpload);\n          queue.push(Promise.resolve(placeholder.placeholder));\n          placeholder.uploaded.then(function (str) {\n            var text = _this13.getMdValue().replace(placeholder.placeholder, str);\n\n            var offset = str.length - placeholder.placeholder.length; // 计算出替换后的光标位置\n\n            var selection = _this13.getSelection();\n\n            _this13.setText(text, undefined, {\n              start: selection.start + offset,\n              end: selection.start + offset\n            });\n          });\n        }\n      } else if (it.kind === 'string' && it.type === 'text/plain') {\n        queue.push(new Promise(function (resolve) {\n          return it.getAsString(resolve);\n        }));\n      }\n    });\n    Promise.all(queue).then(function (res) {\n      var text = res.join('');\n\n      var selection = _this13.getSelection();\n\n      _this13.insertText(text, true, {\n        start: selection.start === selection.end ? text.length : 0,\n        end: text.length\n      });\n    });\n  };\n\n  _proto.render = function render() {\n    var _this14 = this;\n\n    var showHideMenu = this.config.canView && this.config.canView.hideMenu && !this.config.canView.menu;\n    var _this$state = this.state,\n        view = _this$state.view,\n        fullScreen = _this$state.fullScreen;\n\n    var getPluginAt = function getPluginAt(at) {\n      return _this14.state.plugins[at] || [];\n    };\n\n    var isShowMenu = !!view.menu;\n    var id = this.props.id;\n    var editorId = id ? id + \"_md\" : undefined;\n    var previewerId = id ? id + \"_html\" : undefined;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: id,\n      className: \"rc-md-editor \" + (fullScreen ? 'full' : ''),\n      style: this.props.style,\n      onKeyDown: this.handleKeyDown,\n      onDrop: this.handleDrop\n    }, /*#__PURE__*/React.createElement(NavigationBar, {\n      visible: isShowMenu,\n      left: getPluginAt('left'),\n      right: getPluginAt('right')\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-container\"\n    }, showHideMenu && /*#__PURE__*/React.createElement(ToolBar, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-menu\",\n      title: isShowMenu ? 'hidden menu' : 'show menu',\n      onClick: this.handleToggleMenu\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"expand-\" + (isShowMenu ? 'less' : 'more')\n    }))), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-md \" + (view.md ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      id: editorId,\n      ref: this.nodeMdText,\n      name: this.props.name || 'textarea',\n      autoFocus: this.props.autoFocus,\n      placeholder: this.props.placeholder,\n      readOnly: this.props.readOnly,\n      value: this.state.text,\n      className: \"section-container input \" + (this.config.markdownClass || ''),\n      wrap: \"hard\",\n      onChange: this.handleChange,\n      onScroll: this.handleInputScroll,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'md';\n      },\n      onKeyDown: this.handleEditorKeyDown,\n      onPaste: this.handlePaste,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-html \" + (view.html ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: previewerId,\n      className: \"section-container html-wrap\",\n      ref: this.nodeMdPreviewWrapper,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'html';\n      },\n      onScroll: this.handlePreviewScroll\n    }, /*#__PURE__*/React.createElement(HtmlRender, {\n      html: this.state.html,\n      className: this.config.htmlClass,\n      ref: this.nodeMdPreview\n    })))));\n  };\n\n  return Editor;\n}(React.Component);\n\nEditor.plugins = [];\nEditor.addLocale = i18n.add.bind(i18n);\nEditor.useLocale = i18n.setCurrent.bind(i18n);\nEditor.getLocale = i18n.getCurrent.bind(i18n);\nexport default Editor;","map":{"version":3,"names":["_extends","_assertThisInitialized","_inheritsLoose","_createForOfIteratorHelperLoose","o","allowArrayLike","it","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","i","done","value","TypeError","minLen","_arrayLikeToArray","n","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","React","Icon","NavigationBar","ToolBar","i18n","DividerPlugin","Emitter","globalEmitter","initialSelection","getDecorated","mergeConfig","getLineAndCol","isKeyMatch","isPromise","getUploadPlaceholder","defaultConfig","HtmlRender","Editor","_React$Component","use","comp","config","plugins","splice","push","unuse","unuseAll","props","_this","nodeMdText","createRef","nodeMdPreview","nodeMdPreviewWrapper","hasContentChanged","scrollScale","isSyncingScroll","shouldSyncScroll","keyboardListeners","emitter","state","text","defaultValue","replace","html","view","fullScreen","getPlugins","canView","menu","handleChange","handlePaste","handleDrop","handleToggleMenu","handleKeyDown","handleEditorKeyDown","handleLocaleUpdate","handleFocus","handleBlur","handleInputScroll","handleSyncScroll","handlePreviewScroll","_proto","componentDidMount","renderHTML","on","EVENT_LANG_CHANGE","setUp","componentWillUnmount","off","componentDidUpdate","prevProps","String","setState","_this2","addToPlugins","pluginName","_iterator","_step","_iterator2","_step2","concat","result","forEach","align","createElement","editor","editorConfig","key","type","e","_this3","onScroll","emit","EVENT_SCROLL","_this$config$syncScro","syncScrollMode","includes","current","scrollHeight","requestAnimationFrame","scrollTop","markdownText","_this4","console","error","Promise","resolve","res","then","r","setHtml","_this5","setView","onFocus","EVENT_FOCUS","onBlur","EVENT_BLUR","persist","target","setText","allowPasteImage","onImageUpload","event","nativeEvent","items","clipboardData","window","preventDefault","uploadWithDataTransfer","dataTransfer","_this6","keyCode","currentTarget","_text","curPos","selectionStart","lineInfo","emptyCurrentLine","newValue","substr","curLine","undefined","start","end","addSymbol","symbol","insertText","isSymbol","match","isOrderList","toInsert","parseInt","forceUpdate","getMdElement","getHtmlElement","clearSelection","setSelectionRange","getSelection","source","selectionEnd","setSelection","to","focus","insertMarkdown","option","curSelection","decorateOption","imageUrl","linkUrl","curLineStart","getMdValue","lastIndexOf","decorate","selection","newBlock","startLineInfo","col","afterText","trim","insertPlaceholder","placeholder","wait","_this7","str","replaceSelected","newSelection","beforeContent","afterContent","_this8","_this$config$onChange","onChangeTrigger","onChange","getHtmlValue","EVENT_CHANGE","setTimeout","rendering","getHtml","onKeyboard","data","_this9","offKeyboard","_this10","index","indexOf","_iterator3","_step3","callback","EVENT_KEY_DOWN","getEventType","EVENT_FULL_SCREEN","EVENT_VIEW_CHANGE","cb","eventType","_this11","newView","getView","enable","_this12","isFullScreen","_this13","queue","kind","file","getAsFile","uploaded","offset","getAsString","all","join","render","_this14","showHideMenu","hideMenu","_this$state","getPluginAt","at","isShowMenu","id","editorId","previewerId","className","style","onKeyDown","onDrop","visible","left","right","title","onClick","md","ref","autoFocus","readOnly","markdownClass","wrap","onMouseOver","onPaste","htmlClass","Component","addLocale","add","useLocale","setCurrent","getLocale","getCurrent"],"sources":["/Users/lequocvinh/MathSolver/mathSolverVN/node_modules/react-markdown-editor-lite/esm/editor/index.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport * as React from 'react';\nimport Icon from '../components/Icon';\nimport NavigationBar from '../components/NavigationBar';\nimport ToolBar from '../components/ToolBar';\nimport i18n from '../i18n';\nimport DividerPlugin from '../plugins/divider';\nimport Emitter, { globalEmitter } from '../share/emitter';\nimport { initialSelection } from '../share/var';\nimport getDecorated from '../utils/decorate';\nimport mergeConfig from '../utils/mergeConfig';\nimport { getLineAndCol, isKeyMatch, isPromise } from '../utils/tool';\nimport getUploadPlaceholder from '../utils/uploadPlaceholder';\nimport defaultConfig from './defaultConfig';\nimport { HtmlRender } from './preview';\n\nvar Editor = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Editor, _React$Component);\n\n  /**\n   * Register plugin\n   * @param {any} comp Plugin component\n   * @param {any} config Other configs\n   */\n  Editor.use = function use(comp, config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    // Check for duplicate plugins\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1, {\n          comp: comp,\n          config: config\n        });\n        return;\n      }\n    }\n\n    Editor.plugins.push({\n      comp: comp,\n      config: config\n    });\n  }\n  /**\n   * Unregister plugin\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuse = function unuse(comp) {\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1);\n        return;\n      }\n    }\n  }\n  /**\n   * Unregister all plugins\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuseAll = function unuseAll() {\n    Editor.plugins = [];\n  }\n  /**\n   * Locales\n   */\n  ;\n\n  function Editor(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreview = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.hasContentChanged = true;\n    _this.scrollScale = 1;\n    _this.isSyncingScroll = false;\n    _this.shouldSyncScroll = 'md';\n    _this.keyboardListeners = [];\n    _this.emitter = new Emitter();\n    _this.config = mergeConfig(defaultConfig, _this.props.config, _this.props);\n    _this.state = {\n      text: (_this.props.value || _this.props.defaultValue || '').replace(/↵/g, '\\n'),\n      html: '',\n      view: _this.config.view || defaultConfig.view,\n      fullScreen: false,\n      plugins: _this.getPlugins()\n    };\n\n    if (_this.config.canView && !_this.config.canView.menu) {\n      _this.state.view.menu = false;\n    }\n\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handlePaste = _this.handlePaste.bind(_assertThisInitialized(_this));\n    _this.handleDrop = _this.handleDrop.bind(_assertThisInitialized(_this));\n    _this.handleToggleMenu = _this.handleToggleMenu.bind(_assertThisInitialized(_this));\n    _this.handleKeyDown = _this.handleKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleEditorKeyDown = _this.handleEditorKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleLocaleUpdate = _this.handleLocaleUpdate.bind(_assertThisInitialized(_this));\n    _this.handleFocus = _this.handleFocus.bind(_assertThisInitialized(_this));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_this));\n    _this.handleInputScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'md');\n    _this.handlePreviewScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'html');\n    return _this;\n  }\n\n  var _proto = Editor.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var text = this.state.text;\n    this.renderHTML(text);\n    globalEmitter.on(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate); // init i18n\n\n    i18n.setUp();\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    globalEmitter.off(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate);\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (typeof this.props.value !== 'undefined' && this.props.value !== this.state.text) {\n      var value = this.props.value;\n\n      if (typeof value !== 'string') {\n        value = String(value).toString();\n      }\n\n      value = value.replace(/↵/g, '\\n');\n\n      if (this.state.text !== value) {\n        this.setState({\n          text: value\n        });\n        this.renderHTML(value);\n      }\n    }\n\n    if (prevProps.plugins !== this.props.plugins) {\n      this.setState({\n        plugins: this.getPlugins()\n      });\n    }\n  };\n\n  _proto.getPlugins = function getPlugins() {\n    var _this2 = this;\n\n    var plugins = [];\n\n    if (this.props.plugins) {\n      // If plugins option is configured, use only specified plugins\n      var addToPlugins = function addToPlugins(name) {\n        if (name === DividerPlugin.pluginName) {\n          plugins.push({\n            comp: DividerPlugin,\n            config: {}\n          });\n          return;\n        }\n\n        for (var _iterator = _createForOfIteratorHelperLoose(Editor.plugins), _step; !(_step = _iterator()).done;) {\n          var it = _step.value;\n\n          if (it.comp.pluginName === name) {\n            plugins.push(it);\n            return;\n          }\n        }\n      };\n\n      for (var _iterator2 = _createForOfIteratorHelperLoose(this.props.plugins), _step2; !(_step2 = _iterator2()).done;) {\n        var name = _step2.value;\n\n        // Special handling of fonts to ensure backward compatibility\n        if (name === 'fonts') {\n          addToPlugins('font-bold');\n          addToPlugins('font-italic');\n          addToPlugins('font-underline');\n          addToPlugins('font-strikethrough');\n          addToPlugins('list-unordered');\n          addToPlugins('list-ordered');\n          addToPlugins('block-quote');\n          addToPlugins('block-wrap');\n          addToPlugins('block-code-inline');\n          addToPlugins('block-code-block');\n        } else {\n          addToPlugins(name);\n        }\n      }\n    } else {\n      // Use all registered plugins\n      plugins = [].concat(Editor.plugins);\n    }\n\n    var result = {};\n    plugins.forEach(function (it) {\n      if (typeof result[it.comp.align] === 'undefined') {\n        result[it.comp.align] = [];\n      }\n\n      result[it.comp.align].push( /*#__PURE__*/React.createElement(it.comp, {\n        editor: _this2,\n        editorConfig: _this2.config,\n        config: _extends({}, it.comp.defaultConfig || {}, it.config || {}),\n        key: it.comp.pluginName\n      }));\n    });\n    return result;\n  } // sync left and right section's scroll\n  ;\n\n  _proto.handleSyncScroll = function handleSyncScroll(type, e) {\n    var _this3 = this;\n\n    // prevent loop\n    if (type !== this.shouldSyncScroll) {\n      return;\n    } // trigger events\n\n\n    if (this.props.onScroll) {\n      this.props.onScroll(e, type);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_SCROLL, e, type); // should sync scroll?\n\n    var _this$config$syncScro = this.config.syncScrollMode,\n        syncScrollMode = _this$config$syncScro === void 0 ? [] : _this$config$syncScro;\n\n    if (!syncScrollMode.includes(type === 'md' ? 'rightFollowLeft' : 'leftFollowRight')) {\n      return;\n    }\n\n    if (this.hasContentChanged && this.nodeMdText.current && this.nodeMdPreviewWrapper.current) {\n      // 计算出左右的比例\n      this.scrollScale = this.nodeMdText.current.scrollHeight / this.nodeMdPreviewWrapper.current.scrollHeight;\n      this.hasContentChanged = false;\n    }\n\n    if (!this.isSyncingScroll) {\n      this.isSyncingScroll = true;\n      requestAnimationFrame(function () {\n        if (_this3.nodeMdText.current && _this3.nodeMdPreviewWrapper.current) {\n          if (type === 'md') {\n            // left to right\n            _this3.nodeMdPreviewWrapper.current.scrollTop = _this3.nodeMdText.current.scrollTop / _this3.scrollScale;\n          } else {\n            // right to left\n            _this3.nodeMdText.current.scrollTop = _this3.nodeMdPreviewWrapper.current.scrollTop * _this3.scrollScale;\n          }\n        }\n\n        _this3.isSyncingScroll = false;\n      });\n    }\n  };\n\n  _proto.renderHTML = function renderHTML(markdownText) {\n    var _this4 = this;\n\n    if (!this.props.renderHTML) {\n      console.error('renderHTML props is required!');\n      return Promise.resolve();\n    }\n\n    var res = this.props.renderHTML(markdownText);\n\n    if (isPromise(res)) {\n      // @ts-ignore\n      return res.then(function (r) {\n        return _this4.setHtml(r);\n      });\n    }\n\n    if (typeof res === 'function') {\n      return this.setHtml(res());\n    }\n\n    return this.setHtml(res);\n  };\n\n  _proto.setHtml = function setHtml(html) {\n    var _this5 = this;\n\n    return new Promise(function (resolve) {\n      _this5.setState({\n        html: html\n      }, resolve);\n    });\n  };\n\n  _proto.handleToggleMenu = function handleToggleMenu() {\n    this.setView({\n      menu: !this.state.view.menu\n    });\n  };\n\n  _proto.handleFocus = function handleFocus(e) {\n    var onFocus = this.props.onFocus;\n\n    if (onFocus) {\n      onFocus(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_FOCUS, e);\n  };\n\n  _proto.handleBlur = function handleBlur(e) {\n    var onBlur = this.props.onBlur;\n\n    if (onBlur) {\n      onBlur(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_BLUR, e);\n  }\n  /**\n   * Text area change event\n   * @param {React.ChangeEvent} e\n   */\n  ;\n\n  _proto.handleChange = function handleChange(e) {\n    e.persist();\n    var value = e.target.value; // 触发内部事件\n\n    this.setText(value, e);\n  }\n  /**\n   * Listen paste event to support paste images\n   */\n  ;\n\n  _proto.handlePaste = function handlePaste(e) {\n    if (!this.config.allowPasteImage || !this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent; // @ts-ignore\n\n    var items = (event.clipboardData || window.clipboardData).items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  } // Drag images to upload\n  ;\n\n  _proto.handleDrop = function handleDrop(e) {\n    if (!this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent;\n\n    if (!event.dataTransfer) {\n      return;\n    }\n\n    var items = event.dataTransfer.items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  };\n\n  _proto.handleEditorKeyDown = function handleEditorKeyDown(e) {\n    var _this6 = this;\n\n    var keyCode = e.keyCode,\n        key = e.key,\n        currentTarget = e.currentTarget;\n\n    if (keyCode === 13 || key === 'Enter') {\n      var _text = e.currentTarget.value;\n      var curPos = currentTarget.selectionStart;\n      var lineInfo = getLineAndCol(_text, curPos);\n\n      var emptyCurrentLine = function emptyCurrentLine() {\n        var newValue = currentTarget.value.substr(0, curPos - lineInfo.curLine.length) + currentTarget.value.substr(curPos);\n\n        _this6.setText(newValue, undefined, {\n          start: curPos - lineInfo.curLine.length,\n          end: curPos - lineInfo.curLine.length\n        });\n\n        e.preventDefault();\n      };\n\n      var addSymbol = function addSymbol(symbol) {\n        _this6.insertText(\"\\n\" + symbol, false, {\n          start: symbol.length + 1,\n          end: symbol.length + 1\n        });\n\n        e.preventDefault();\n      }; // Enter key, check previous line\n\n\n      var isSymbol = lineInfo.curLine.match(/^(\\s?)([-*]) /);\n\n      if (isSymbol) {\n        if (/^(\\s?)([-*]) $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        addSymbol(isSymbol[0]);\n        return;\n      }\n\n      var isOrderList = lineInfo.curLine.match(/^(\\s?)(\\d+)\\. /);\n\n      if (isOrderList) {\n        if (/^(\\s?)(\\d+)\\. $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        var toInsert = \"\" + isOrderList[1] + (parseInt(isOrderList[2], 10) + 1) + \". \";\n        addSymbol(toInsert);\n      }\n    }\n  } // Handle language change\n  ;\n\n  _proto.handleLocaleUpdate = function handleLocaleUpdate() {\n    this.forceUpdate();\n  }\n  /**\n   * Get elements\n   */\n  ;\n\n  _proto.getMdElement = function getMdElement() {\n    return this.nodeMdText.current;\n  };\n\n  _proto.getHtmlElement = function getHtmlElement() {\n    return this.nodeMdPreviewWrapper.current;\n  }\n  /**\n   * Clear selected\n   */\n  ;\n\n  _proto.clearSelection = function clearSelection() {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(0, 0, 'none');\n    }\n  }\n  /**\n   * Get selected\n   * @return {Selection}\n   */\n  ;\n\n  _proto.getSelection = function getSelection() {\n    var source = this.nodeMdText.current;\n\n    if (!source) {\n      return _extends({}, initialSelection);\n    }\n\n    var start = source.selectionStart;\n    var end = source.selectionEnd;\n    var text = (source.value || '').slice(start, end);\n    return {\n      start: start,\n      end: end,\n      text: text\n    };\n  }\n  /**\n   * Set selected\n   * @param {Selection} to\n   */\n  ;\n\n  _proto.setSelection = function setSelection(to) {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(to.start, to.end, 'forward');\n      this.nodeMdText.current.focus();\n    }\n  }\n  /**\n   * Insert markdown text\n   * @param type\n   * @param option\n   */\n  ;\n\n  _proto.insertMarkdown = function insertMarkdown(type, option) {\n    if (option === void 0) {\n      option = {};\n    }\n\n    var curSelection = this.getSelection();\n    var decorateOption = option ? _extends({}, option) : {};\n\n    if (type === 'image') {\n      decorateOption = _extends({}, decorateOption, {\n        target: option.target || curSelection.text || '',\n        imageUrl: option.imageUrl || this.config.imageUrl\n      });\n    }\n\n    if (type === 'link') {\n      decorateOption = _extends({}, decorateOption, {\n        linkUrl: this.config.linkUrl\n      });\n    }\n\n    if (type === 'tab' && curSelection.start !== curSelection.end) {\n      var curLineStart = this.getMdValue().slice(0, curSelection.start).lastIndexOf('\\n') + 1;\n      this.setSelection({\n        start: curLineStart,\n        end: curSelection.end\n      });\n    }\n\n    var decorate = getDecorated(curSelection.text, type, decorateOption);\n    var text = decorate.text;\n    var selection = decorate.selection;\n\n    if (decorate.newBlock) {\n      var startLineInfo = getLineAndCol(this.getMdValue(), curSelection.start);\n      var col = startLineInfo.col,\n          curLine = startLineInfo.curLine;\n\n      if (col > 0 && curLine.length > 0) {\n        text = \"\\n\" + text;\n\n        if (selection) {\n          selection.start++;\n          selection.end++;\n        }\n      }\n\n      var afterText = startLineInfo.afterText;\n\n      if (curSelection.start !== curSelection.end) {\n        afterText = getLineAndCol(this.getMdValue(), curSelection.end).afterText;\n      }\n\n      if (afterText.trim() !== '' && afterText.substr(0, 2) !== '\\n\\n') {\n        if (afterText.substr(0, 1) !== '\\n') {\n          text += '\\n';\n        }\n\n        text += '\\n';\n      }\n    }\n\n    this.insertText(text, true, selection);\n  }\n  /**\n   * Insert a placeholder, and replace it when the Promise resolved\n   * @param placeholder\n   * @param wait\n   */\n  ;\n\n  _proto.insertPlaceholder = function insertPlaceholder(placeholder, wait) {\n    var _this7 = this;\n\n    this.insertText(placeholder, true);\n    wait.then(function (str) {\n      var text = _this7.getMdValue().replace(placeholder, str);\n\n      _this7.setText(text);\n    });\n  }\n  /**\n   * Insert text\n   * @param {string} value The text will be insert\n   * @param {boolean} replaceSelected Replace selected text\n   * @param {Selection} newSelection New selection\n   */\n  ;\n\n  _proto.insertText = function insertText(value, replaceSelected, newSelection) {\n    if (value === void 0) {\n      value = '';\n    }\n\n    if (replaceSelected === void 0) {\n      replaceSelected = false;\n    }\n\n    var text = this.state.text;\n    var selection = this.getSelection();\n    var beforeContent = text.slice(0, selection.start);\n    var afterContent = text.slice(replaceSelected ? selection.end : selection.start, text.length);\n    this.setText(beforeContent + value + afterContent, undefined, newSelection ? {\n      start: newSelection.start + beforeContent.length,\n      end: newSelection.end + beforeContent.length\n    } : {\n      start: selection.start,\n      end: selection.start\n    });\n  }\n  /**\n   * Set text, and trigger onChange event\n   * @param {string} value\n   * @param {any} event\n   */\n  ;\n\n  _proto.setText = function setText(value, event, newSelection) {\n    var _this8 = this;\n\n    if (value === void 0) {\n      value = '';\n    }\n\n    var _this$config$onChange = this.config.onChangeTrigger,\n        onChangeTrigger = _this$config$onChange === void 0 ? 'both' : _this$config$onChange;\n    var text = value.replace(/↵/g, '\\n');\n\n    if (this.state.text === value) {\n      return;\n    }\n\n    this.setState({\n      text: text\n    });\n\n    if (this.props.onChange && (onChangeTrigger === 'both' || onChangeTrigger === 'beforeRender')) {\n      this.props.onChange({\n        text: text,\n        html: this.getHtmlValue()\n      }, event);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_CHANGE, value, event, typeof event === 'undefined');\n\n    if (newSelection) {\n      setTimeout(function () {\n        return _this8.setSelection(newSelection);\n      });\n    }\n\n    if (!this.hasContentChanged) {\n      this.hasContentChanged = true;\n    }\n\n    var rendering = this.renderHTML(text);\n\n    if (onChangeTrigger === 'both' || onChangeTrigger === 'afterRender') {\n      rendering.then(function () {\n        if (_this8.props.onChange) {\n          _this8.props.onChange({\n            text: _this8.state.text,\n            html: _this8.getHtmlValue()\n          }, event);\n        }\n      });\n    }\n  }\n  /**\n   * Get text value\n   * @return {string}\n   */\n  ;\n\n  _proto.getMdValue = function getMdValue() {\n    return this.state.text;\n  }\n  /**\n   * Get rendered html\n   * @returns {string}\n   */\n  ;\n\n  _proto.getHtmlValue = function getHtmlValue() {\n    if (typeof this.state.html === 'string') {\n      return this.state.html;\n    }\n\n    if (this.nodeMdPreview.current) {\n      return this.nodeMdPreview.current.getHtml();\n    }\n\n    return '';\n  }\n  /**\n   * Listen keyboard events\n   */\n  ;\n\n  /**\n   * Listen keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  _proto.onKeyboard = function onKeyboard(data) {\n    var _this9 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this9.onKeyboard(it);\n      });\n      return;\n    }\n\n    if (!this.keyboardListeners.includes(data)) {\n      this.keyboardListeners.push(data);\n    }\n  }\n  /**\n   * Unlisten keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  ;\n\n  _proto.offKeyboard = function offKeyboard(data) {\n    var _this10 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this10.offKeyboard(it);\n      });\n      return;\n    }\n\n    var index = this.keyboardListeners.indexOf(data);\n\n    if (index >= 0) {\n      this.keyboardListeners.splice(index, 1);\n    }\n  };\n\n  _proto.handleKeyDown = function handleKeyDown(e) {\n    // 遍历监听数组，找找有没有被监听\n    for (var _iterator3 = _createForOfIteratorHelperLoose(this.keyboardListeners), _step3; !(_step3 = _iterator3()).done;) {\n      var it = _step3.value;\n\n      if (isKeyMatch(e, it)) {\n        e.preventDefault();\n        it.callback(e);\n        return;\n      }\n    } // 如果没有，触发默认事件\n\n\n    this.emitter.emit(this.emitter.EVENT_KEY_DOWN, e);\n  };\n\n  _proto.getEventType = function getEventType(event) {\n    switch (event) {\n      case 'change':\n        return this.emitter.EVENT_CHANGE;\n\n      case 'fullscreen':\n        return this.emitter.EVENT_FULL_SCREEN;\n\n      case 'viewchange':\n        return this.emitter.EVENT_VIEW_CHANGE;\n\n      case 'keydown':\n        return this.emitter.EVENT_KEY_DOWN;\n\n      case 'blur':\n        return this.emitter.EVENT_BLUR;\n\n      case 'focus':\n        return this.emitter.EVENT_FOCUS;\n\n      case 'scroll':\n        return this.emitter.EVENT_SCROLL;\n    }\n  }\n  /**\n   * Listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.on = function on(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.on(eventType, cb);\n    }\n  }\n  /**\n   * Unlisten events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.off = function off(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.off(eventType, cb);\n    }\n  }\n  /**\n   * Set view property\n   * Can show or hide: editor, preview, menu\n   * @param {object} to\n   */\n  ;\n\n  _proto.setView = function setView(to) {\n    var _this11 = this;\n\n    var newView = _extends({}, this.state.view, to);\n\n    this.setState({\n      view: newView\n    }, function () {\n      _this11.emitter.emit(_this11.emitter.EVENT_VIEW_CHANGE, newView);\n    });\n  }\n  /**\n   * Get view property\n   * @return {object}\n   */\n  ;\n\n  _proto.getView = function getView() {\n    return _extends({}, this.state.view);\n  }\n  /**\n   * Enter or exit full screen\n   * @param {boolean} enable\n   */\n  ;\n\n  _proto.fullScreen = function fullScreen(enable) {\n    var _this12 = this;\n\n    if (this.state.fullScreen !== enable) {\n      this.setState({\n        fullScreen: enable\n      }, function () {\n        _this12.emitter.emit(_this12.emitter.EVENT_FULL_SCREEN, enable);\n      });\n    }\n  }\n  /**\n   * Is full screen\n   * @return {boolean}\n   */\n  ;\n\n  _proto.isFullScreen = function isFullScreen() {\n    return this.state.fullScreen;\n  };\n\n  _proto.uploadWithDataTransfer = function uploadWithDataTransfer(items) {\n    var _this13 = this;\n\n    var onImageUpload = this.config.onImageUpload;\n\n    if (!onImageUpload) {\n      return;\n    }\n\n    var queue = [];\n    Array.prototype.forEach.call(items, function (it) {\n      if (it.kind === 'file' && it.type.includes('image')) {\n        var file = it.getAsFile();\n\n        if (file) {\n          var placeholder = getUploadPlaceholder(file, onImageUpload);\n          queue.push(Promise.resolve(placeholder.placeholder));\n          placeholder.uploaded.then(function (str) {\n            var text = _this13.getMdValue().replace(placeholder.placeholder, str);\n\n            var offset = str.length - placeholder.placeholder.length; // 计算出替换后的光标位置\n\n            var selection = _this13.getSelection();\n\n            _this13.setText(text, undefined, {\n              start: selection.start + offset,\n              end: selection.start + offset\n            });\n          });\n        }\n      } else if (it.kind === 'string' && it.type === 'text/plain') {\n        queue.push(new Promise(function (resolve) {\n          return it.getAsString(resolve);\n        }));\n      }\n    });\n    Promise.all(queue).then(function (res) {\n      var text = res.join('');\n\n      var selection = _this13.getSelection();\n\n      _this13.insertText(text, true, {\n        start: selection.start === selection.end ? text.length : 0,\n        end: text.length\n      });\n    });\n  };\n\n  _proto.render = function render() {\n    var _this14 = this;\n\n    var showHideMenu = this.config.canView && this.config.canView.hideMenu && !this.config.canView.menu;\n    var _this$state = this.state,\n        view = _this$state.view,\n        fullScreen = _this$state.fullScreen;\n\n    var getPluginAt = function getPluginAt(at) {\n      return _this14.state.plugins[at] || [];\n    };\n\n    var isShowMenu = !!view.menu;\n    var id = this.props.id;\n    var editorId = id ? id + \"_md\" : undefined;\n    var previewerId = id ? id + \"_html\" : undefined;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: id,\n      className: \"rc-md-editor \" + (fullScreen ? 'full' : ''),\n      style: this.props.style,\n      onKeyDown: this.handleKeyDown,\n      onDrop: this.handleDrop\n    }, /*#__PURE__*/React.createElement(NavigationBar, {\n      visible: isShowMenu,\n      left: getPluginAt('left'),\n      right: getPluginAt('right')\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-container\"\n    }, showHideMenu && /*#__PURE__*/React.createElement(ToolBar, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-menu\",\n      title: isShowMenu ? 'hidden menu' : 'show menu',\n      onClick: this.handleToggleMenu\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"expand-\" + (isShowMenu ? 'less' : 'more')\n    }))), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-md \" + (view.md ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      id: editorId,\n      ref: this.nodeMdText,\n      name: this.props.name || 'textarea',\n      autoFocus: this.props.autoFocus,\n      placeholder: this.props.placeholder,\n      readOnly: this.props.readOnly,\n      value: this.state.text,\n      className: \"section-container input \" + (this.config.markdownClass || ''),\n      wrap: \"hard\",\n      onChange: this.handleChange,\n      onScroll: this.handleInputScroll,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'md';\n      },\n      onKeyDown: this.handleEditorKeyDown,\n      onPaste: this.handlePaste,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-html \" + (view.html ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: previewerId,\n      className: \"section-container html-wrap\",\n      ref: this.nodeMdPreviewWrapper,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'html';\n      },\n      onScroll: this.handlePreviewScroll\n    }, /*#__PURE__*/React.createElement(HtmlRender, {\n      html: this.state.html,\n      className: this.config.htmlClass,\n      ref: this.nodeMdPreview\n    })))));\n  };\n\n  return Editor;\n}(React.Component);\n\nEditor.plugins = [];\nEditor.addLocale = i18n.add.bind(i18n);\nEditor.useLocale = i18n.setCurrent.bind(i18n);\nEditor.getLocale = i18n.getCurrent.bind(i18n);\nexport default Editor;"],"mappings":"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"},"metadata":{},"sourceType":"module"}